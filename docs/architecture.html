<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Studio Smart - Architettura v4.0</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .version-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            color: #764ba2;
            margin-bottom: 12px;
            font-size: 1.3rem;
        }
        
        .card p {
            color: #666;
            margin-bottom: 16px;
            line-height: 1.6;
        }
        
        .card-link {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: transform 0.2s;
        }
        
        .card-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 8px;
        }
        
        .architecture-diagram {
            background: white;
            padding: 24px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
        }
        
        .tech-stack {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .tech-row {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 16px;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .tech-row:last-child {
            border-bottom: none;
        }
        
        .tech-label {
            font-weight: 600;
            color: #764ba2;
        }
        
        .tech-value {
            color: #333;
        }
        
        .feature-list {
            display: grid;
            gap: 12px;
            margin: 20px 0;
        }
        
        .feature-item {
            padding: 12px 16px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 4px;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 24px;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .back-link:hover {
            background: #667eea;
            color: white;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .content { padding: 20px; }
            .card-grid { grid-template-columns: 1fr; }
            .tech-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ CRM Studio Smart</h1>
            <p style="font-size: 1.1rem; margin-top: 10px;">Architettura & Documentazione Tecnica</p>
            <div class="version-badge">Versione 4.0.4 - Dicembre 2025</div>
        </div>
        
        <div class="content">
            <!-- OVERVIEW -->
            <div class="section">
                <h2 class="section-title">ğŸ¯ Overview Progetto</h2>
                <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 20px;">
                    <strong>CRM Studio Smart</strong> Ã¨ un sistema completo di gestione clienti progettato per studi legali e professionali. 
                    Integra timesheet, fatturazione, pacchetti ore, gestione scadenze e molto altro in un'unica applicazione web moderna, performante e offline-capable.
                </p>
                
                <p style="line-height: 1.8; color: #666;">
                    Il sistema Ã¨ stato progettato per massimizzare efficienza e usabilitÃ , con particolare attenzione a:
                </p>
                <ul style="margin: 16px 0 20px 20px; line-height: 2;">
                    <li>ğŸš€ <strong>Performance:</strong> Cache intelligente (+70% velocitÃ ), micro-caching backend</li>
                    <li>ğŸ“± <strong>Mobile-first:</strong> PWA installabile, funziona offline</li>
                    <li>ğŸ”’ <strong>Data integrity:</strong> Validazione robusta, sistema log completo</li>
                    <li>âš¡ <strong>Zero server cost:</strong> GitHub Pages + Google Apps Script</li>
                    <li>ğŸ”„ <strong>Real-time sync:</strong> Google Sheets come database cloud</li>
                </ul>
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-number">~9.000</span>
                        <span class="stat-label">Righe di Codice</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">14</span>
                        <span class="stat-label">File Backend (.gs)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">9</span>
                        <span class="stat-label">File Frontend (.js)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">33+</span>
                        <span class="stat-label">API Endpoints</span>
                    </div>
                </div>
            </div>
            
            <!-- ARCHITETTURA -->
            <div class="section">
                <h2 class="section-title">ğŸ—ï¸ Architettura Generale</h2>
                
                <div class="tech-stack">
                    <div class="tech-row">
                        <div class="tech-label">Frontend:</div>
                        <div class="tech-value">HTML5 + Vanilla JavaScript + CSS3 (PWA)</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">Backend:</div>
                        <div class="tech-value">Google Apps Script (Serverless)</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">Database:</div>
                        <div class="tech-value">Google Sheets (Cloud Spreadsheet)</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">API:</div>
                        <div class="tech-value">REST over HTTPS, JSON response format</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">Deployment:</div>
                        <div class="tech-value">GitHub Pages (frontend) + Apps Script Web App (backend)</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">Caching:</div>
                        <div class="tech-value">Service Worker (frontend) + Micro-cache (backend)</div>
                    </div>
                    <div class="tech-row">
                        <div class="tech-label">Versioning:</div>
                        <div class="tech-value">Git (GitHub) + Apps Script native versioning</div>
                    </div>
                </div>
                
                <div class="architecture-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTENTE (Browser)                               â”‚
â”‚                      Desktop / Mobile / Tablet                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTPS
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND (GitHub Pages)                             â”‚
â”‚                   https://niubbone.github.io/TSFE/                     â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  index.html  â”‚  â”‚  JavaScript   â”‚  â”‚ Service Worker â”‚             â”‚
â”‚  â”‚   + CSS      â”‚â†’ â”‚  Modules      â”‚â†’ â”‚   (Cache)      â”‚             â”‚
â”‚  â”‚              â”‚  â”‚               â”‚  â”‚                â”‚             â”‚
â”‚  â”‚  â€¢ UI/UX     â”‚  â”‚ â€¢ main.js     â”‚  â”‚ â€¢ Offline      â”‚             â”‚
â”‚  â”‚  â€¢ Forms     â”‚  â”‚ â€¢ client.js   â”‚  â”‚ â€¢ Cache API    â”‚             â”‚
â”‚  â”‚  â€¢ Modals    â”‚  â”‚ â€¢ vendite.js  â”‚  â”‚ â€¢ Background   â”‚             â”‚
â”‚  â”‚  â€¢ Tables    â”‚  â”‚ â€¢ dom.js      â”‚  â”‚   Sync         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                         â”‚
â”‚  State: window.clients, window.packets (in-memory cache)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ REST API (GET/POST)
                               â”‚ ?action=get_data&params=...
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BACKEND (Google Apps Script)                          â”‚
â”‚                        Serverless Runtime                              â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Router.gs   â”‚â†’ â”‚     Business Logic Layer         â”‚               â”‚
â”‚  â”‚              â”‚  â”‚                                  â”‚               â”‚
â”‚  â”‚  doGet(e)    â”‚  â”‚  â€¢ Clienti.gs     â€¢ Vendite.gs  â”‚               â”‚
â”‚  â”‚  doPost(e)   â”‚  â”‚  â€¢ Timesheet.gs   â€¢ Firme.gs    â”‚               â”‚
â”‚  â”‚              â”‚  â”‚  â€¢ Pacchetti.gs   â€¢ Canoni.gs   â”‚               â”‚
â”‚  â”‚  Switch/Case â”‚  â”‚  â€¢ Proforma.gs    â€¢ Email.gs    â”‚               â”‚
â”‚  â”‚  Routing     â”‚  â”‚  â€¢ Calendar.gs    â€¢ Log.gs      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚              Utility & Cache Layer                        â”‚         â”‚
â”‚  â”‚  â€¢ crm_utils.gs (helpers, validation)                    â”‚         â”‚
â”‚  â”‚  â€¢ Cache.gs (micro-cache: clienti +70% perf)             â”‚         â”‚
â”‚  â”‚  â€¢ crm_email.gs (template email automation)              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ SpreadsheetApp API
                               â”‚ getSheetByName(), getRange(), setValues()
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATABASE (Google Sheets)                           â”‚
â”‚                        Cloud Spreadsheet                               â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Clienti   â”‚  â”‚ Timesheet  â”‚  â”‚ Pacchetti  â”‚  â”‚  Proforma  â”‚     â”‚
â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚     â”‚
â”‚  â”‚ â€¢ ID       â”‚  â”‚ â€¢ ID       â”‚  â”‚ â€¢ ID       â”‚  â”‚ â€¢ NÂ°       â”‚     â”‚
â”‚  â”‚ â€¢ Nome     â”‚  â”‚ â€¢ Cliente  â”‚  â”‚ â€¢ Cliente  â”‚  â”‚ â€¢ Cliente  â”‚     â”‚
â”‚  â”‚ â€¢ Email    â”‚  â”‚ â€¢ Data     â”‚  â”‚ â€¢ Ore Tot  â”‚  â”‚ â€¢ Importo  â”‚     â”‚
â”‚  â”‚ â€¢ Telefono â”‚  â”‚ â€¢ Ore      â”‚  â”‚ â€¢ Residue  â”‚  â”‚ â€¢ Data     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Canoni   â”‚  â”‚   Firme    â”‚  â”‚    Log     â”‚  â”‚   Config   â”‚     â”‚
â”‚  â”‚            â”‚  â”‚  Digitali  â”‚  â”‚            â”‚  â”‚            â”‚     â”‚
â”‚  â”‚ â€¢ ID       â”‚  â”‚ â€¢ ID       â”‚  â”‚ â€¢ Time     â”‚  â”‚ â€¢ Settings â”‚     â”‚
â”‚  â”‚ â€¢ Cliente  â”‚  â”‚ â€¢ Cliente  â”‚  â”‚ â€¢ Action   â”‚  â”‚ â€¢ API Keys â”‚     â”‚
â”‚  â”‚ â€¢ Importo  â”‚  â”‚ â€¢ Tipo     â”‚  â”‚ â€¢ User     â”‚  â”‚ â€¢ Globals  â”‚     â”‚
â”‚  â”‚ â€¢ Scadenza â”‚  â”‚ â€¢ Scadenza â”‚  â”‚ â€¢ Result   â”‚  â”‚            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                         â”‚
â”‚  Formule: SUMIF, VLOOKUP, COUNTIF per aggregazioni real-time          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  INTEGRAZIONI ESTERNE       â”‚
                    â”‚                             â”‚
                    â”‚  â€¢ Google Calendar API      â”‚
                    â”‚    (scadenze automatiche)   â”‚
                    â”‚                             â”‚
                    â”‚  â€¢ Gmail API               â”‚
                    â”‚    (email notifiche)        â”‚
                    â”‚                             â”‚
                    â”‚  â€¢ Google Docs API         â”‚
                    â”‚    (proforma template)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
            </div>
            
            <!-- DATA FLOW -->
            <div class="section">
                <h2 class="section-title">ğŸ”„ Data Flow Esempio</h2>
                
                <div class="architecture-diagram">
<pre>
ESEMPIO: Inserimento Nuovo Cliente

1. UTENTE
   â””â”€> Compila form cliente (nome, email, telefono)
   â””â”€> Click "Salva Cliente"

2. FRONTEND (client.js)
   â””â”€> Valida input (email format, campi required)
   â””â”€> showLoadingState()
   â””â”€> fetch(`${API_URL}?action=insert_client&nome=...&email=...`)

3. BACKEND (Router.gs)
   â””â”€> doGet(e) riceve request
   â””â”€> switch(e.parameter.action)
   â””â”€> case 'insert_client': return insertClient(e.parameter)

4. BUSINESS LOGIC (Clienti.gs)
   â””â”€> insertClient(params)
       â”œâ”€> validateClientData(params) // check email duplicati
       â”œâ”€> generateClientID() // C_2025_001
       â”œâ”€> getSpreadsheet().getSheetByName('Clienti')
       â”œâ”€> appendRow([id, nome, email, tel, ...])
       â”œâ”€> writeLog('SUCCESS', 'INSERT_CLIENT', ...)
       â”œâ”€> invalidateCacheClienti() // cache refresh
       â””â”€> return {success: true, clientId: "C_2025_001"}

5. FRONTEND RESPONSE
   â””â”€> result = await response.json()
   â””â”€> if (result.success):
       â”œâ”€> updateClientsList() // reload lista
       â”œâ”€> closeModal('client-modal')
       â”œâ”€> showSuccessMessage("Cliente creato!")
       â””â”€> window.clients.push(newClient) // update cache

6. GOOGLE SHEETS
   â””â”€> Nuova riga in foglio "Clienti"
   â””â”€> Trigger formule automatiche (es: COUNTIF per stats)
   â””â”€> Data disponibile immediatamente per altre funzioni
</pre>
                </div>
            </div>
            
            <!-- COMPONENTI -->
            <div class="section">
                <h2 class="section-title">ğŸ“¦ Componenti Principali</h2>
                
                <div class="card-grid">
                    <div class="card">
                        <h3>ğŸ“˜ Backend Reference</h3>
                        <p>Google Apps Script: API endpoints, funzioni core, gestione database Google Sheets, micro-caching, sistema log completo</p>
                        <a href="arc_backend.html" class="card-link">Apri Backend Docs â†’</a>
                    </div>
                    
                    <div class="card">
                        <h3>ğŸ“— Frontend Reference</h3>
                        <p>JavaScript modules: struttura codice, UI components, state management, PWA features, Service Worker strategy</p>
                        <a href="arc_frontend.html" class="card-link">Apri Frontend Docs â†’</a>
                    </div>
                    
                    <div class="card">
                        <h3>âš¡ Quick Reference</h3>
                        <p>Cheat sheet sviluppo: endpoints API, funzioni chiave, pattern comuni, esempi codice ready-to-use</p>
                        <a href="tech_sheet.html" class="card-link">Apri Tech Sheet â†’</a>
                    </div>
                </div>
            </div>
            
            <!-- DEPLOYMENT -->
            <div class="section">
                <h2 class="section-title">ğŸš€ Deployment & Infrastructure</h2>
                
                <div class="card-grid">
                    <div class="card">
                        <h3>Frontend (GitHub Pages)</h3>
                        <p><strong>URL Produzione:</strong><br>
                        <code>https://niubbone.github.io/TSFE/</code></p>
                        
                        <p style="margin-top: 12px;"><strong>Caratteristiche:</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>âœ… PWA installabile</li>
                            <li>âœ… Service Worker attivo</li>
                            <li>âœ… Offline-capable</li>
                            <li>âœ… HTTPS nativo</li>
                            <li>âœ… CDN globale</li>
                        </ul>
                        
                        <p style="margin-top: 12px;"><strong>Deploy:</strong><br>
                        <code>git push origin main</code><br>
                        Auto-deploy in ~1 minuto</p>
                    </div>
                    
                    <div class="card">
                        <h3>Backend (Google Apps Script)</h3>
                        <p><strong>Runtime:</strong><br>
                        Google Apps Script V8 Engine</p>
                        
                        <p style="margin-top: 12px;"><strong>Caratteristiche:</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>âœ… Serverless (zero cost)</li>
                            <li>âœ… Auto-scaling</li>
                            <li>âœ… Micro-cache attivo</li>
                            <li>âœ… Execution time: ~2-3s avg</li>
                            <li>âœ… 99.9% uptime</li>
                        </ul>
                        
                        <p style="margin-top: 12px;"><strong>Deploy:</strong><br>
                        Apps Script Editor â†’ Deploy â†’ New version<br>
                        Versioning automatico</p>
                    </div>
                </div>
            </div>
            
            <!-- FEATURES -->
            <div class="section">
                <h2 class="section-title">âœ¨ FunzionalitÃ  Principali</h2>
                
                <div class="feature-list">
                    <div class="feature-item">
                        âœ… <strong>Gestione Clienti:</strong> CRUD completo, ricerca avanzata, validazione email, deduplicazione automatica
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Timesheet:</strong> Tracciamento ore con modalitÃ  addebito (orario/forfait), export CSV, filtri avanzati
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Pacchetti Ore:</strong> Gestione automatica residui, calcolo scadenze, notifiche esaurimento
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Proforma:</strong> Generazione automatica con template Google Docs, numerazione progressiva, export PDF
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Vendite - Canoni:</strong> Gestione abbonamenti periodici, rinnovo automatico, Calendar integration
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Vendite - Firme Digitali:</strong> Token/Remota, durata 3 anni, alert scadenze 30/10 giorni
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Vendite - Pacchetti:</strong> Creazione pacchetti ore prepagati, tracking consumo, residui real-time
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Scadenzario:</strong> Google Calendar integrato, email automatiche, dashboard scadenze
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Sistema Rinnovi:</strong> Storico completo rinnovi canoni/firme, chain tracking
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Sistema Log:</strong> Tracciamento completo operazioni, data integrity check, query log avanzate
                    </div>
                    <div class="feature-item">
                        âœ… <strong>PWA:</strong> Installabile su desktop/mobile, cache intelligente, sync background
                    </div>
                    <div class="feature-item">
                        âœ… <strong>Performance:</strong> Micro-cache +70%, Service Worker, lazy loading, debounced search
                    </div>
                </div>
            </div>
            
            <!-- PERFORMANCE METRICS -->
            <div class="section">
                <h2 class="section-title">ğŸ“Š Performance & Metrics</h2>
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-number">+70%</span>
                        <span class="stat-label">Performance Gain<br>(Micro-cache)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">~2-3s</span>
                        <span class="stat-label">Avg API Response<br>(cached: ~200ms)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">100%</span>
                        <span class="stat-label">Offline Capability<br>(Service Worker)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number">0â‚¬</span>
                        <span class="stat-label">Server Cost<br>(Serverless)</span>
                    </div>
                </div>
                
                <div class="tech-stack" style="margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 16px;">ğŸ¯ Ottimizzazioni Implementate</h3>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Backend:</strong> Micro-cache clienti (5min TTL), query optimization, batch operations</li>
                        <li><strong>Frontend:</strong> Service Worker caching, debounced search (300ms), lazy modals</li>
                        <li><strong>Network:</strong> Request deduplication, retry logic, timeout management</li>
                        <li><strong>Database:</strong> Indexed ranges, VLOOKUP optimization, formula caching</li>
                    </ul>
                </div>
            </div>
            
            <!-- SECURITY -->
            <div class="section">
                <h2 class="section-title">ğŸ”’ Security & Data Integrity</h2>
                
                <div class="feature-list">
                    <div class="feature-item">
                        ğŸ” <strong>HTTPS Only:</strong> GitHub Pages (SSL) + Apps Script (SSL), no mixed content
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>Input Validation:</strong> Frontend (UI) + Backend (business logic), double layer
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>Email Validation:</strong> Regex pattern + domain verification, deduplicazione
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>SQL Injection:</strong> N/A (Google Sheets, no SQL queries)
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>XSS Protection:</strong> No innerHTML con user input, sanitization layer
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>Data Backup:</strong> Google Sheets native versioning (30 giorni history)
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>Audit Log:</strong> Tutte operazioni CRUD logged con timestamp + user
                    </div>
                    <div class="feature-item">
                        ğŸ” <strong>Access Control:</strong> Apps Script deployed "as user" (OAuth Google)
                    </div>
                </div>
            </div>
            
            <!-- FUTURE ROADMAP -->
            <div class="section">
                <h2 class="section-title">ğŸš€ Roadmap & Future Development</h2>
                
                <div class="card-grid">
                    <div class="card">
                        <h3>âœ… Completato (v4.0)</h3>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Backend refactoring completo</li>
                            <li>PWA implementation</li>
                            <li>Micro-cache system</li>
                            <li>Sistema rinnovi</li>
                            <li>Version management</li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h3>ğŸ”„ In Progress (v4.1)</h3>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Frontend refactoring (modules)</li>
                            <li>Enhanced error handling</li>
                            <li>Advanced analytics dashboard</li>
                            <li>Export improvements</li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h3>ğŸ“‹ Planned (v4.2+)</h3>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Multi-user support</li>
                            <li>Advanced reporting</li>
                            <li>Mobile app (native)</li>
                            <li>API v2 (GraphQL?)</li>
                            <li>Real-time collaboration</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- BACK LINK -->
            <div style="text-align: center; margin-top: 40px;">
                <a href="../index.html" class="back-link">â† Torna all'Applicazione</a>
            </div>
        </div>
    </div>
</body>
</html>
